# AI 对话持久化与管理工具

统一脚本 `ai-context.sh` 提供保存 / 恢复 / 列出 / 查看 / 搜索 等操作。

## 📁 目录结构
```
.ai-context/
├── README.md
├── ai-context.sh              # 统一管理脚本
└── session-YYYYMMDD-HHMMSS.md # 会话记录文件 (多个)
```

## 🚀 常用操作

### 保存当前会话内容
交互式输入(结束 Ctrl+D):
```bash
./.ai-context/ai-context.sh save
```
从文件保存并加标题:
```bash
./.ai-context/ai-context.sh save -f notes.md -t "阶段总结"
```
管道:
```bash
some_cmd | ./.ai-context/ai-context.sh save -t Pipeline
```

### 恢复(输出最新会话内容)
```bash
./.ai-context/ai-context.sh restore
```
复制输出内容到新的 AI 对话里即可续接。

### 列出/查看
```bash
./.ai-context/ai-context.sh list          # 列出所有
./.ai-context/ai-context.sh show latest   # 显示最新
./.ai-context/ai-context.sh show session-20250812-120000.md
```

### 搜索历史会话
```bash
./.ai-context/ai-context.sh grep PlayerModel
```

### 编辑最新会话
```bash
./.ai-context/ai-context.sh edit
```
默认使用 $EDITOR (未设置则假定 code)。

### 获取最新文件路径
```bash
./.ai-context/ai-context.sh latest --path
```

## 🧩 子命令速览
| 子命令 | 说明 |
| ------ | ---- |
| save | 保存新会话，可 -f / -t / -e |
| restore | 输出最新会话(兼容旧 restore-context.sh) |
| latest | 输出最新文件内容或 --path 仅路径 |
| list | 列出所有会话 |
| show | 显示指定文件或 latest |
| grep | 正则搜索内容 |
| edit | 用编辑器打开最新(无则创建) |
| help | 帮助信息 |

## 📝 命名规则
session-YYYYMMDD-HHMMSS.md 例如: session-20250812-195418.md

## 💡 提示
- 建议在重要讨论结束后执行一次 save
- 可以手动补充文件以增强上下文
- 搜索功能可快速定位历史决策与路径排查日志

## ♻️ 迁移说明
旧脚本 restore-context.sh 与 save-session.sh 已合并进 ai-context.sh。

## ⚙️ 环境变量
| 变量 | 作用 | 默认 |
| ---- | ---- | ---- |
| AI_CONTEXT_DIR | 存储目录 | 脚本所在目录 |
| EDITOR | 编辑器命令 | code |

## ✅ 示例: 一次完整流程
```bash
./.ai-context/ai-context.sh save -t "模型路径排查" < debug_log.txt
./.ai-context/ai-context.sh list
./.ai-context/ai-context.sh grep BoundingBox
./.ai-context/ai-context.sh restore
```

## 🛠 退出码
0 成功 / 1 参数错误 / 2 未找到文件或内容为空

---
Generated by ai-context.sh consolidating previous scripts.
