# "Show Weapon"功能详解

## 🔫 "Show Weapon"菜单项的作用

"Show Weapon"是Tools菜单中的一个checkbox选项，用于控制第一人称射击游戏中**武器模型的显示和隐藏**。

## 🎮 显示内容

当"Show Weapon"被勾选（启用）时，游戏会在屏幕上渲染：

### 武器几何体
- **形状**: 简单的立方体几何体作为武器的替代模型
- **位置**: 位于玩家视角的右下角区域
- **坐标**: 
  - X轴: 0.1 到 0.3 (屏幕右侧)
  - Y轴: -0.1 到 0.1 (屏幕下方)  
  - Z轴: -0.4 (距离相机0.4单位)
- **颜色**: 蓝色色调
- **用途**: 代表玩家手持的武器

### 视觉效果
- **武器摆动**: 走路时武器会有自然的摆动动画
- **动态位置**: 武器位置会根据玩家移动产生轻微的偏移和旋转
- **深度渲染**: 使用正确的3D变换和深度测试

## 🎯 具体实现细节

### 渲染位置计算
```swift
// 武器基础位置 (相对于相机)
weaponOffset = Float3(0.3, -0.2, -0.5)  // 右下角位置

// 动态摆动效果
let basePosition = weaponOffset + weaponSway

// 最终变换矩阵
let weaponMatrix = translation * rotation
```

### 几何体数据
- **顶点**: 4个顶点构成一个矩形面
- **三角形**: 2个三角形组成武器的正面
- **材质**: 包含法线、纹理坐标、切线等完整的渲染数据

## 🖥️ 用户体验

### 启用状态 (checkbox勾选 ✅)
- 屏幕右下角显示蓝色的武器几何体
- 武器会跟随玩家移动产生摆动效果
- 提供典型FPS游戏的第一人称武器视觉体验

### 禁用状态 (checkbox未勾选 ❌)
- 武器完全隐藏，不进行渲染
- 屏幕右下角区域为空
- 控制台显示: "❌ 武器被隐藏，不渲染"
- 节省渲染资源

## 🎬 配合其他功能

### 与"Show Arms"的关系
- **Show Weapon**: 控制武器本体的显示
- **Show Arms**: 控制手臂的显示 (屏幕左下和右下的手臂几何体)
- 可以独立控制，创造不同的视觉组合

### 动画系统集成
- 武器显示时支持射击动画
- 支持重新装弹动画
- 支持武器摆动和移动效果

## 🔧 开发者信息

### 控制流程
1. **AppDelegate**: `toggleWeapon()` → 更新`weaponVisible`状态
2. **GameEngine**: `setWeaponVisible()` → 传递到渲染系统
3. **FirstPersonRenderer**: `setWeaponVisible()` → 控制`showWeapon`标志
4. **渲染循环**: 检查`showWeapon`标志决定是否调用武器渲染

### 调试信息
```
🔫 菜单操作: 切换武器显示状态 -> 显示
🔫 武器显示状态已更新: 可见
🔫 准备渲染武器...
🎯 直接渲染简单武器几何体
🎯 渲染了备用武器几何体
```

## 🎨 视觉预期

用户启用"Show Weapon"后，应该在游戏窗口的**右下角**看到一个**蓝色的矩形几何体**，这个几何体代表玩家持有的武器。它会：

- 在屏幕右下角固定位置显示
- 跟随玩家移动产生自然的摆动
- 提供第一人称射击游戏的沉浸感
- 与手臂几何体配合形成完整的FPS视觉体验

这是FPS游戏中标准的"武器视图"功能，让玩家能够看到自己角色手中的武器！
