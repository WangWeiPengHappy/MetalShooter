# ESC键鼠标捕获控制功能

## 功能概述

新增了ESC键控制鼠标捕获的功能，让玩家可以方便地在游戏模式和普通鼠标模式之间切换。

## 功能详情

### 🔓 ESC键 - 禁用鼠标捕获
- **按键**: ESC
- **功能**: 立即禁用鼠标捕获，鼠标可以自由移动，不再影响游戏视角
- **状态**: 按下ESC后，鼠标移动不会传递给游戏，鼠标按键事件也会被忽略
- **用途**: 允许玩家在游戏中暂时使用鼠标进行其他操作（如点击菜单、调整窗口等）

### 🔒 左键点击 - 重新启用鼠标捕获  
- **按键**: 鼠标左键点击
- **功能**: 当鼠标捕获被禁用时，点击鼠标左键会重新启用捕获
- **状态**: 重新启用后，鼠标移动和按键事件恢复正常传递给游戏
- **用途**: 方便玩家快速回到游戏模式

### 🎛️ 菜单控制 - Tools > Enable/Disable Mouse Capture
- **快捷键**: Shift+Cmd+M
- **功能**: 通过菜单手动控制鼠标捕获状态
- **状态显示**: 
  - ✅ "Disable Mouse Capture" - 当前已启用捕获
  - ❌ "Enable Mouse Capture" - 当前已禁用捕获

## 使用场景

### 场景1: 游戏中查看菜单
1. 正在游戏中，鼠标控制视角
2. 按ESC键禁用鼠标捕获
3. 现在可以自由使用鼠标点击Tools菜单等
4. 点击鼠标左键重新开始游戏

### 场景2: 调试和测试
1. 开发者需要在游戏运行时调整设置
2. 按ESC键释放鼠标
3. 使用菜单调整Triangle、Weapon等设置
4. 点击鼠标重新进入游戏模式

### 场景3: 窗口管理
1. 需要移动或调整游戏窗口大小
2. 按ESC键释放鼠标控制
3. 拖拽窗口或调整大小
4. 完成后点击游戏区域重新启用捕获

## 技术实现

### InputManager增强
- 添加了鼠标捕获状态管理
- ESC键自动禁用捕获
- 左键点击重新启用捕获
- 捕获状态控制鼠标事件的传递

### AppDelegate集成
- 添加了菜单项显示捕获状态
- 提供手动控制界面
- 状态同步和显示

## 调试信息

应用会在控制台输出详细的调试信息：

```
🔓 InputManager: ESC键按下，禁用鼠标捕获
🖱️ InputManager: 鼠标捕获已禁用
🚫 InputManager: 鼠标未捕获，忽略移动事件
🔒 InputManager: 鼠标左键点击，重新启用鼠标捕获
🖱️ InputManager: 鼠标捕获已启用
```

这些信息可以帮助开发者和测试人员了解功能的工作状态。

## 兼容性

- ✅ 与现有的FPS控制系统完全兼容
- ✅ 不影响其他输入事件处理
- ✅ 保持与Triangle、Weapon控制的独立性
- ✅ 支持键盘快捷键和菜单控制双重方式

---

**使用建议**: 在FPS游戏中，建议默认启用鼠标捕获以获得最佳游戏体验。只在需要使用界面或进行调试时才临时禁用。
